{% extends "base.html" %}

{% block title %}Продукция - БД Мебельной компании{% endblock %}

{% block content %}
<h2>Продукция</h2>

<div style="margin: 20px 0; display: flex; justify-content: space-between; align-items: center;">
    <form method="GET" style="margin: 0;">
        <input type="text" name="search" class="search-box" placeholder="Поиск по названию или артикулу..." value="{{ search }}">
        <button type="submit" class="btn">Найти</button>
        {% if search %}
        <a href="{{ url_for('products') }}" class="btn">Сбросить</a>
        {% endif %}
    </form>
    
    <a href="{{ url_for('add_product') }}" class="btn btn-success">Добавить продукцию</a>
</div>

{% if products %}
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Артикул</th>
            <th>Тип</th>
            <th>Материал</th>
            <th>Цена</th>
            <th>Статус</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for product in products %}
        <tr>
            <td>{{ product.product_id }}</td>
            <td><strong>{{ product.product_name }}</strong></td>
            <td>{{ product.article_number }}</td>
            <td>{{ product.product_type_name }}</td>
            <td>{{ product.material_type_name }}</td>
            <td>{{ "{:,.0f}".format(product.min_partner_price) }} ₽</td>
            <td>
                {% if product.is_available %}
                <span style="color: green;">Доступен</span>
                {% else %}
                <span style="color: red;">Недоступен</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('edit_product', product_id=product.product_id) }}" class="btn" style="padding: 8px 16px; font-size: 14px;">Изменить</a>
                <a href="{{ url_for('delete_product', product_id=product.product_id) }}" 
                   class="btn btn-danger" 
                   style="padding: 8px 16px; font-size: 14px;"
                   onclick="return confirm('Удалить продукцию?')">Удалить</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<p style="margin-top: 20px; color: #6c757d;">
    Всего найдено: <strong>{{ products|length }}</strong> записей
</p>
{% else %}
<div class="alert alert-danger">
    Продукция не найдена. {% if search %}Попробуйте изменить поисковый запрос.{% endif %}
</div>
{% endif %}
{% endblock %}
